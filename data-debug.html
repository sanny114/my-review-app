<!DOCTYPE html>
<html>
<head>
    <title>ãƒ‡ãƒ¼ã‚¿ãƒ‡ãƒãƒƒã‚°ãƒ„ãƒ¼ãƒ«</title>
    <meta charset="utf-8">
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .card { border: 1px solid #ddd; padding: 15px; margin: 10px 0; border-radius: 5px; }
        .button { padding: 10px 20px; margin: 5px; background: #007bff; color: white; border: none; border-radius: 3px; cursor: pointer; }
        .button:hover { background: #0056b3; }
        .warning { background: #fff3cd; border: 1px solid #ffeaa7; }
        .success { background: #d4edda; border: 1px solid #c3e6cb; }
        .danger { background: #f8d7da; border: 1px solid #f5c6cb; }
        pre { background: #f8f9fa; padding: 10px; border-radius: 3px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>ğŸ” ãƒ‡ãƒ¼ã‚¿ãƒ‡ãƒãƒƒã‚°ãƒ„ãƒ¼ãƒ«</h1>
    
    <div class="card warning">
        <h3>âš ï¸ æ³¨æ„</h3>
        <p>ã“ã®ãƒ„ãƒ¼ãƒ«ã¯é–‹ç™ºè€…å‘ã‘ã§ã™ã€‚ãƒ‡ãƒ¼ã‚¿ã®ç¢ºèªã¨ç·Šæ€¥æ™‚ã®ä¿®æ­£ã«ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚</p>
    </div>

    <div class="card">
        <h3>ğŸ“Š ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿çŠ¶æ³</h3>
        <button onclick="checkDataStatus()">ãƒ‡ãƒ¼ã‚¿çŠ¶æ³ã‚’ç¢ºèª</button>
        <div id="dataStatus"></div>
    </div>

    <div class="card">
        <h3>ğŸ§¹ ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—</h3>
        <button onclick="clearLocalStorage()">ãƒ­ãƒ¼ã‚«ãƒ«Storageã‚’ã‚¯ãƒªã‚¢</button>
        <button onclick="backupLocalStorage()">ãƒ­ãƒ¼ã‚«ãƒ«Storageã‚’ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—</button>
        <div id="cleanupStatus"></div>
    </div>

    <script>
        function checkDataStatus() {
            const statusDiv = document.getElementById('dataStatus');
            let html = '<h4>ãƒ‡ãƒ¼ã‚¿ç¢ºèªçµæœ:</h4>';
            
            // LocalStorageç¢ºèª
            const localData = localStorage.getItem('review-app-db-v1');
            if (localData) {
                try {
                    const parsed = JSON.parse(localData);
                    html += `<div class="warning">
                        <strong>ğŸ—„ï¸ LocalStorage:</strong><br>
                        å•é¡Œ: ${parsed.problems?.length || 0}ä»¶<br>
                        å¾©ç¿’ãƒ­ã‚°: ${parsed.reviewLogs?.length || 0}ä»¶<br>
                        <small>âš ï¸ LocalStorageãƒ‡ãƒ¼ã‚¿ãŒæ®‹ã£ã¦ã„ã¾ã™</small>
                    </div>`;
                } catch (e) {
                    html += `<div class="danger">âŒ LocalStorageãƒ‡ãƒ¼ã‚¿ãŒç ´æã—ã¦ã„ã¾ã™</div>`;
                }
            } else {
                html += `<div class="success">âœ… LocalStorageã¯ã‚¯ãƒªã‚¢ã•ã‚Œã¦ã„ã¾ã™</div>`;
            }
            
            // BackupStorageç¢ºèª
            const backupData = localStorage.getItem('review-app-db-v1-backup');
            if (backupData) {
                try {
                    const parsed = JSON.parse(backupData);
                    html += `<div class="success">
                        <strong>ğŸ“¦ Backup:</strong><br>
                        å•é¡Œ: ${parsed.problems?.length || 0}ä»¶<br>
                        å¾©ç¿’ãƒ­ã‚°: ${parsed.reviewLogs?.length || 0}ä»¶<br>
                        <small>âœ… ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãŒä¿å­˜ã•ã‚Œã¦ã„ã¾ã™</small>
                    </div>`;
                } catch (e) {
                    html += `<div class="warning">âš ï¸ ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ã‚¿ã«å•é¡ŒãŒã‚ã‚Šã¾ã™</div>`;
                }
            } else {
                html += `<div>ğŸ“¦ ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¯ã‚ã‚Šã¾ã›ã‚“</div>`;
            }
            
            statusDiv.innerHTML = html;
        }
        
        function clearLocalStorage() {
            if (!confirm('LocalStorageã®ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã™ã€‚\næœ¬å½“ã«ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ\n\nâ€» ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸã«ç§»è¡Œæ¸ˆã¿ã®å ´åˆã¯å®‰å…¨ã§ã™')) {
                return;
            }
            
            try {
                // ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’ä½œæˆ
                const data = localStorage.getItem('review-app-db-v1');
                if (data) {
                    localStorage.setItem('review-app-db-v1-manual-backup-' + Date.now(), data);
                }
                
                // LocalStorageã‚’ã‚¯ãƒªã‚¢
                localStorage.removeItem('review-app-db-v1');
                
                document.getElementById('cleanupStatus').innerHTML = `
                    <div class="success">
                        âœ… LocalStorageã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸã€‚<br>
                        ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚‚ä½œæˆæ¸ˆã¿ã§ã™ã€‚<br>
                        <strong>ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¦ãã ã•ã„ã€‚</strong>
                    </div>
                `;
            } catch (error) {
                document.getElementById('cleanupStatus').innerHTML = `
                    <div class="danger">âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}</div>
                `;
            }
        }
        
        function backupLocalStorage() {
            try {
                const data = localStorage.getItem('review-app-db-v1');
                if (data) {
                    const backup = JSON.parse(data);
                    const blob = new Blob([JSON.stringify(backup, null, 2)], { type: 'application/json' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `review-app-backup-${new Date().toISOString().split('T')[0]}.json`;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                    
                    document.getElementById('cleanupStatus').innerHTML = `
                        <div class="success">âœ… ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã—ãŸ</div>
                    `;
                } else {
                    document.getElementById('cleanupStatus').innerHTML = `
                        <div class="warning">âš ï¸ ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</div>
                    `;
                }
            } catch (error) {
                document.getElementById('cleanupStatus').innerHTML = `
                    <div class="danger">âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}</div>
                `;
            }
        }
        
        // åˆæœŸãƒã‚§ãƒƒã‚¯
        window.onload = function() {
            checkDataStatus();
        };
    </script>
</body>
</html>
